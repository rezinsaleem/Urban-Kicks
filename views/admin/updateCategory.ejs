<%- include('../partials/adminHead') -%>
<style>
   h2{
    color: #3086d5;
  }
</style>

<main role="main" class="main-content">
<div class="container mt-5">
  <div class="container mt-5">
    <h2>Edit Category</h2>
    <form action="/admin/updatecategory/<%= category._id %>" method="POST" enctype="application/x-www-form-urlencoded">
      <div class="form-group">
        <label for="name">Name:</label>
        <input type="text" class="form-control" id="name" name="name" value="<%= category.name %>" required>
        <div id="nameError" class="text-danger"></div>
      </div>
      <div class="form-group">
        <label for="description">Description:</label>
        <textarea class="form-control" id="description" name="description" required><%= category.description %></textarea>
        <div id="descriptionError" class="text-danger"></div>
      </div>
      <div class="form-group ">
        <label for="price">Discount:   (in Percentage)</label>
        <input type="number" class="form-control" id="discount" name="discount" min="0" value="<%=category.discount%>" required>
        <div id="discountError" class="text-danger"></div>
      </div>
      <button type="submit" class="btn btn-primary">Update Category</button>
    </form>
</div>

</main>
</div>

<script>
  function validateForm() {
    var name = document.getElementById('name').value;
    var description = document.getElementById('description').value;
    var nameError = document.getElementById('nameError');
    var descriptionError = document.getElementById('descriptionError');

    // Reset error messages
    nameError.innerHTML = '';
    descriptionError.innerHTML = '';

    // Validate name
    if (name.trim() === '') {
      nameError.innerHTML = 'Name is required.';
      return false;
    } else if (/\d/.test(name)) {
      nameError.innerHTML = 'Name must not contain numbers.';
      return false;
    }

    // Validate description
    if (description.trim() === '') {
      descriptionError.innerHTML = 'Description is required.';
      return false;
    }

    return true;
  }
  </script>

<script>

  const form = document.querySelector('form');
  
  form.addEventListener('submit', async (event) => {
    event.preventDefault(); // Prevent the default form submission
    if (validateForm()) {
    try {
      // Display success Swal
      await Swal.fire({
        icon: 'success',
        title: 'Category updated Successfully',
        showConfirmButton: false,
        timer: 1000
      });
  
      // After displaying the success Swal, submit the form
      form.submit();
    } catch (error) {
      console.error('Error:', error);
      
    }
  }
  });
  
    </script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>


<%- include('../partials/adminFooter') -%>